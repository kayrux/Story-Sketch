<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="styles/style.css" />
  <style>
    /* Add chat styles for children */
    #chat-container {
      border: 2px solid #6FB4FF;
      padding: 10px;
      width: 800px; /* Increase the width for more space */
      height: 500px; /* Increase the height for more space */
      margin: 20px auto;
      background-color: #F8F8F8;
      overflow-y: scroll;
      border-radius: 20px;
      left: 60px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
      position: relative; /* For positioning the bot character */

      display: none; /* Hide the chat container initially */
    }
    .message {
      margin-bottom: 10px;
      padding: 10px;
      border-radius: 10px;
      position: relative;
      left: auto;
      font-size: 18px;
    }
    .user {
      text-align: right;
      background-color: #6FB4FF;
      color: white;
    }
    .bot {
      text-align: left;
      background-color: #FFA07A;
      color: white;
    }
    /* Style for the user input field and submit button */
    #user-input {
      width: 650px; /* Match the width of the chat container */
      padding: 15px;
      position: relative;
      left: 220px;
      font-size: 18px;
      border: none;
      margin: 20px;
      border-radius: 20px;
      outline: 2px solid #6FB4FF; /* Add an outline to the input field */
      display: none; /* Hide the input field initially */
    }
    #submit-button {
      display: none; /* Hide the submit button initially */
      position: relative;
      top: -70px;
      left: 950px;
      width: 100px;
      height: 50px;
    }
    /* Bot character */
    #bot-character {
      width: 200px; /* Adjust the size as needed */
      position: absolute;
      top: 70px; /* Move the robot character down */
      left: 10px; /* Adjust the left position to avoid covering the input field */
      display: none; /* Hide the bot character initially */
    }
    /* Style for the bot's typing animation (GIF) */
    #typing-gif {
      width: 200px; /* Adjust the size as needed */
      position: absolute;
      top: 70px; /* Move the typing GIF down to match the robot character */
      left: 10px; /* Adjust the left position to match the bot character */
      display: none; /* Hide the GIF initially */
    }
    /* Style for the video container */
    #video-container {
      position: relative;
      text-align: center;
    }
    #video {
      width: 100%;
      height: 500px; /* Adjust the height as needed to cover the chat and button */
    }
    #continue-button {
      position: absolute;
      top: 10px;
      right: 10px;
      background-color: #6FB4FF;
      color: white;
      border: none;
      padding: 10px 20px;
      cursor: pointer;
      border-radius: 20px;
      font-size: 18px;
    }
  </style>
  <script>
    const chatPrompts = [
      {
        question: "What's the name of the main character in our story?",
        answer: "Jess",
      },
      {
        question: "Where does Jess live? Is it in a big city, a small town, or maybe in a magical forest?",
        answer: "She lives in a new planet made of candy",
      },
      {
        question: "What is the most amazing adventure or quest that Jess goes on in the candy planet? Is there a special mission or something magical that happens to her?",
        answer: "There's a problem with cavities",
      },
      {
        question: "Who are Jess's friends on this candy planet? Do they have any special abilities or qualities that could help them solve the problem of cavities?",
        answer: "She has a gingerbread friend named Ginger",
      },
      {
        question: "How does Ginger help Jess and their friends tackle the problem of cavities in the candy planet? Does Ginger have any special skills or ideas to share?",
        answer: "He knows the way to a dentist",
      },
      {
        question: "What challenges or obstacles do they face on their journey to find a dentist in the candy planet? Are there any fun or exciting moments along the way?",
        answer: "They see different candy on different planets",
      },
      {
        question: "Can you describe one of the candy planets they visit and what kind of candy creatures or landscapes they encounter there?",
        answer: "Nerds, they have smart nerd candy there",
      },
      {
        question: "How does Jess and her friends eventually find their way to a dentist to solve the cavities problem? Do they learn any valuable lessons along the way?",
        answer: "Not too sure but they try not to eat too much candy",
      },
    ];

    const synth = window.speechSynthesis; // Initialize the speech synthesis

    let currentPromptIndex = 0;
    let isStoryDisplayed = false;

    // Function to display chat messages
    // Function to display chat messages
function displayMessages() {
  const chatContainer = document.getElementById('chat-container');
  const question = questions[currentQuestionIndex];

  const messageElement = document.createElement('div');
  messageElement.classList.add('message', 'bot');
  messageElement.innerText = question.question;

  chatContainer.appendChild(messageElement);

  // If it's a bot message, read it aloud
  if (currentQuestionIndex < questions.length) {
    readAloud(question.question);
  }

  // Smoothly scroll to the bottom of the chat container
  chatContainer.scrollTop = chatContainer.scrollHeight;
}


    // Function to read text aloud
    function readAloud(text) {
      const utterance = new SpeechSynthesisUtterance(text);
      synth.speak(utterance);
    }

    // Function to handle user input
    function handleUserInput() {
      const userInput = document.getElementById('user-input').value;
      const chatContainer = document.getElementById('chat-container');

      if (isStoryDisplayed) {
        // If the story is already displayed, tell the user to try again
        const errorMessageElement = document.createElement('div');
        errorMessageElement.classList.add('message', 'bot');
        errorMessageElement.innerText = "Bot: Please try again or continue the story.";

        chatContainer.appendChild(errorMessageElement);
        readAloud("Please try again or continue the story.");

        // Clear the input field
        document.getElementById('user-input').value = '';
        return;
      }

      if (userInput) {
        // Check if the user's response matches the expected answer
        const prompt = chatPrompts[currentPromptIndex];
        if (userInput.toLowerCase().includes(prompt.answer.toLowerCase())) {
          // User provided the expected answer, move to the next prompt
          currentPromptIndex++;
        }

        if (currentPromptIndex < chatPrompts.length) {
          // Display the next bot prompt
          const nextPrompt = chatPrompts[currentPromptIndex];
          const botMessageElement = document.createElement('div');
          botMessageElement.classList.add('message', 'bot');
          botMessageElement.innerText = nextPrompt.question;
          chatContainer.appendChild(botMessageElement);
          readAloud(nextPrompt.question);
        } else {
          // All prompts answered, display the story
          isStoryDisplayed = true;
          displayStory();
        }

        // Clear the input field
        document.getElementById('user-input').value = '';

        // Smoothly scroll to the bottom of the chat container
        chatContainer.scrollTop = chatContainer.scrollHeight;
      }
    }

    // Function to display the story
    function displayStory() {
      const chatContainer = document.getElementById('chat-container');

      // Your story content goes here
      const storyContent = `
        Once upon a time, on a new planet made entirely of candy, there lived a little girl named Jess. She had a special friend, Ginger the gingerbread cookie. The candy planet was a magical place, with lollipop trees and chocolate rivers, but it also had a big problem â€“ cavities!

        One day, Jess and Ginger decided to do something about it. Ginger knew the way to a wise dentist who could help them. So, they embarked on a candy-filled adventure through the candy planet. Along the way, they visited different planets made of various candies. One planet was filled with nerdy candy, and they met smart nerd candy creatures who helped them learn the importance of not eating too much candy.

        As Jess and Ginger journeyed from candy planet to candy planet, they encountered delicious treats and faced challenges. They resisted the temptation to eat too much candy, for they knew it was the cause of the cavities problem.

        Finally, after a long and exciting adventure, they reached the dentist's office. The dentist, a kind and caring candy expert, taught them all about the importance of good dental hygiene and how to take care of their teeth in the candy world.

        With newfound knowledge and determination, Jess, Ginger, and their candy planet friends started a campaign to promote healthier candy-eating habits. They spread the word about balanced candy consumption and encouraged everyone to visit the dentist regularly.

        Over time, the candy planet transformed into a healthier, happier place, with fewer cavities and brighter smiles. Jess and Ginger had not only solved the cavities problem but also made lifelong friends on their sweet adventure.

        And so, in the candy planet, where sweets and adventures awaited at every turn, Jess and Ginger's story became a sweet legend that children told each other, reminding everyone to enjoy candy in moderation and always take care of their precious teeth.

        The end!
      `;

      // Display the story in the chat container
      const storyMessageElement = document.createElement('div');
      storyMessageElement.classList.add('message', 'bot');
      storyMessageElement.innerHTML = `Bot: ${storyContent}`;
      chatContainer.appendChild(storyMessageElement);

      // Read the story aloud
      readAloud(storyContent);

      // Show the "Continue" button
      const continueButton = document.getElementById('continue-button');
      continueButton.style.display = 'inline';

      // Smoothly scroll to the bottom of the chat container
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    // Function to continue the video
    function continueVideo() {
      const video = document.getElementById('video');
      const chatContainer = document.getElementById('chat-container');
      const continueButton = document.getElementById('continue-button');
      const botCharacter = document.getElementById('bot-character');
      const userInput = document.getElementById('user-input');
      const submitButton = document.getElementById('submit-button');

      video.pause(); // Pause the video

      video.style.display = 'none'; // Hide the video element
      chatContainer.style.display = 'block'; // Show the chat container
      continueButton.style.display = 'none'; // Hide the "Continue" button
      botCharacter.style.display = 'block'; // Show the bot character
      userInput.style.display = 'block'; // Show the user input field
      submitButton.style.display = 'block'; // Show the submit button

      // Display the next chat prompt if there are more prompts
      if (currentPromptIndex < chatPrompts.length) {
        const nextPrompt = chatPrompts[currentPromptIndex];
        const botMessageElement = document.createElement('div');
        botMessageElement.classList.add('message', 'bot');
        botMessageElement.innerText = nextPrompt.question;
        chatContainer.appendChild(botMessageElement);
        readAloud(nextPrompt.question);
      }

      // Smoothly scroll to the bottom of the chat container
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }
  </script>
</head>
<body>
  <!-- Home page -->
  <div class="title">Welcome to ChatBot Adventures!</div>
  <button onclick="window.location.href = 'story.html';">Start Drawing</button>
  <button onclick="window.location.href = 'help.html';">Help</button>

  <!-- Video container -->
  <div id="video-container">
    <video id="video" controls>
      <source src="intro-video.mp4" type="video/mp4">
      Your browser does not support the video tag.
    </video>
    <button id="continue-button" onclick="continueVideo()">Continue</button>
  </div>

  <!-- Chat container -->
  <div id="chat-container">
    <!-- Chat messages will appear here -->
  </div>

  <!-- User input field and submit button -->
  <input type="text" id="user-input" placeholder="Your answer...">
  <button id="submit-button" onclick="handleUserInput();">Submit</button>

  <!-- Bot character image -->
  <img src="bot-character.png" alt="ChatBot" id="bot-character">
  <!-- Typing GIF -->
  <img src="typing.gif" alt="Typing" id="typing-gif">

  <script>
    // Call the function to display chat messages
    displayMessages();
  </script>
</body>
</html>

